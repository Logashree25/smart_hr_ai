<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Smart HR Portal - Basic Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .header {
            color: #0070f3;
            border-bottom: 2px solid #0070f3;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .button {
            background-color: #0070f3;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
        .button:hover {
            background-color: #0051cc;
        }
        .data-panel {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border-left: 4px solid #0070f3;
        }
        .loading {
            color: #666;
            font-style: italic;
        }
        .error {
            color: #dc3545;
            background-color: #f8d7da;
            padding: 10px;
            border-radius: 4px;
        }
        .success {
            color: #155724;
            background-color: #d4edda;
            padding: 10px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="header">Smart HR Portal</h1>
        <p>AI-Powered HR Management System</p>
        
        <div>
            <button class="button" onclick="loadEmployees()">View Employees</button>
            <button class="button" onclick="loadDepartments()">Department Summary</button>
            <button class="button" onclick="generateInsights()">Generate AI Insights</button>
            <button class="button" onclick="analyzeTeamPerformance()">Team Performance</button>
            <button class="button" onclick="analyzePolicyGaps()">Policy Analysis</button>
        </div>
        
        <div id="dataPanel" class="data-panel">
            <h3>Data Panel</h3>
            <p>Click a button above to load data</p>
        </div>
    </div>

    <script>
        function updatePanel(title, content, type = 'info') {
            const panel = document.getElementById('dataPanel');
            let className = '';
            if (type === 'loading') className = 'loading';
            else if (type === 'error') className = 'error';
            else if (type === 'success') className = 'success';
            
            panel.innerHTML = `<h3>${title}</h3><div class="${className}">${content}</div>`;
        }

        function loadEmployees() {
            updatePanel('Loading Employees...', 'Fetching employee data from server...', 'loading');
            
            fetch('/hr/Employees')
                .then(response => response.json())
                .then(data => {
                    console.log('Employees data:', data);
                    let html = `<p>Found ${data.value.length} employees:</p><ul>`;
                    data.value.forEach(emp => {
                        html += `<li><strong>${emp.FirstName} ${emp.LastName}</strong> - ${emp.Role} (${emp.Department}, ${emp.Team}, ${emp.Location})</li>`;
                    });
                    html += '</ul>';
                    updatePanel('Employees', html, 'success');
                })
                .catch(error => {
                    console.error('Error loading employees:', error);
                    updatePanel('Error Loading Employees', `Error: ${error.message}`, 'error');
                });
        }

        function loadDepartments() {
            updatePanel('Loading Departments...', 'Fetching department data from server...', 'loading');
            
            fetch('/hr/DepartmentSummary')
                .then(response => response.json())
                .then(data => {
                    console.log('Departments data:', data);
                    let html = `<p>Found ${data.value.length} departments:</p><ul>`;
                    data.value.forEach(dept => {
                        html += `<li><strong>${dept.Department}</strong> - ${dept.EmployeeCount} employees (${dept.FullTimeCount} full-time)</li>`;
                    });
                    html += '</ul>';
                    updatePanel('Department Summary', html, 'success');
                })
                .catch(error => {
                    console.error('Error loading departments:', error);
                    updatePanel('Error Loading Departments', `Error: ${error.message}`, 'error');
                });
        }

        function generateInsights() {
            updatePanel('Generating AI Insights...', 'Analyzing engagement opportunities for Engineering department...', 'loading');
            
            fetch('/hr/generateEngagementIdeas', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    department: 'Engineering'
                })
            })
            .then(response => response.json())
            .then(data => {
                console.log('AI Insights:', data);
                updatePanel('AI Engagement Ideas', `<p>${data.value}</p>`, 'success');
            })
            .catch(error => {
                console.error('Error generating insights:', error);
                updatePanel('Error Generating Insights', `Error: ${error.message}`, 'error');
            });
        }

        function analyzeTeamPerformance() {
            updatePanel('Analyzing Team Performance...', 'Analyzing Engineering team performance metrics...', 'loading');
            
            fetch('/hr/analyzeTeamPerformance', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    department: 'Engineering'
                })
            })
            .then(response => response.json())
            .then(data => {
                console.log('Team Performance:', data);
                const formattedText = data.value.replace(/\n/g, '<br>');
                updatePanel('Team Performance Analysis', `<p>${formattedText}</p>`, 'success');
            })
            .catch(error => {
                console.error('Error analyzing team performance:', error);
                updatePanel('Error Analyzing Team Performance', `Error: ${error.message}`, 'error');
            });
        }

        function analyzePolicyGaps() {
            updatePanel('Analyzing Policy Gaps...', 'Generating policy enhancement recommendations...', 'loading');
            
            fetch('/hr/analyzePolicyGaps', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({})
            })
            .then(response => response.json())
            .then(data => {
                console.log('Policy Analysis:', data);
                updatePanel('Policy Gap Analysis', `<p>${data.value}</p>`, 'success');
            })
            .catch(error => {
                console.error('Error analyzing policy gaps:', error);
                updatePanel('Error Analyzing Policy Gaps', `Error: ${error.message}`, 'error');
            });
        }

        // Load initial data
        setTimeout(() => {
            loadEmployees();
        }, 1000);
    </script>
</body>
</html>
